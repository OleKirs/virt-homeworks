# Домашнее задание к занятию "5.1. Основы виртуализации"

## Задача 1

Вкратце опишите, как вы поняли - в чем основное отличие паравиртуализации и виртуализации на основе ОС.

### Решение:  
**Паравиртуализация** – Виртуализация на уровне устройств.  
Каждая гостевая ВМ работает со своим отдельным экземпляром ядра ОС (ОС на ВМ могут быть разные), которое общается с аппаратными средствами хоста через виртуальные устройства, эмулируемые гипервизором, работающем поверх хостовой ОС.
**Виртуализации на основе ОС** – это метод изоляции виртуальных сред (контейнеров) на основе единой ОС без необходимости виртуализации устройств.  
При этом типе виртуализации единое для всех контейнеров ядро операционной системы поддерживает несколько изолированных экземпляров пространства пользователя для запуска в них относительно независимых вариантов программного кода (сервисов).

## Задача 2

Выберите тип один из вариантов использования организации физических серверов, 
в зависимости от условий использования.

Организация серверов:
- физические сервера
- паравиртуализация
- виртуализация уровня ОС

Условия использования:

- Высоконагруженная база данных, чувствительная к отказу
- Различные Java-приложения
- Windows системы для использования Бухгалтерским отделом 
- Системы, выполняющие высокопроизводительные расчеты на GPU

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

### Решение:  

**•	Высоконагруженная база данных, чувствительная к отказу** – Кластер из физических серверов или хостов с виртуализацией уровня ОС, т.к. это решение позволяет не терять производительность на виртуализацию систем ввода-вывода и при этом устранить простой при недоступности одного из серверов кластера (плановой или аварийной остановке сервиса)  

**•	Различные Java-приложения** - виртуализация уровня ОС, т.к. это решение позволяет изолировать среды исполнения кода не теряя производительности для приложений и позволяет сократить затраты ресурсов на саму виртуализацию (т.к. используется единое ядро ОС).

**•	Windows системы для использования Бухгалтерским отделом** – Зависит от схемы работы приложений, но в общем случае имеет смысл ориентироваться на паравиртуализацию на основе ОС Windows Server с ролью Hyper-V. Отказоустойчивость можно обеспечить кластеризацией хостов или настройкой репликации экземпляров ВМ между хостами.  
        Основными преимуществами такого решения считаю:  
        -	Консолидацию систем с уплотнением размещения повышением утилизации ресурсов, т.к. обычно такие системы работают в режиме частичных нагрузок.  
        -	Нативную поддержку гостевых ВМ хостами на основе Hyper-V.  
        -	Отсутствие необходимости поддержки других ОС, как следствие снижение требований к административному персоналу ИТ.  
        -	Возможность реализации всего стека технологий (включая мониторинг, управление ВМ и архивацию) на основе продуктов одного вендора, что может упростить развёртывание и поддержку системы.   
        -	Экономию на лицензиях на ОС.  

**•	Системы, выполняющие высокопроизводительные расчеты на GPU** – физические сервера, т.к. для наиболее полной реализации возможностей GPU желательно виртуализацию не использовать.
При необходимости обеспечения требований к непрерывности процесса при отсутствии таких возможностей на уровне приложения можно рассмотреть реализацию на основе систем с поддержкой проброса аппаратных ресурсов внутрь ВМ и последующей миграцией таких ВМ средствами гипервизоров.

## Задача 3

Как вы думаете, возможно ли совмещать несколько типов виртуализации на одном сервере?
Приведите пример такого совмещения.

### Решение:  

Совмещение нескольких типов виртуализации возможно. Например, так:  

•	Одновременная работа KVM и Docker на одном хосте (удобно для лабораторных стендов).

•	Запуск Qemu/KVM внутри контейнера. Может быть использовано для запуска ВМ с отличным от хоста ядром ОС внутри инфраструктуры на основе контейнеров.  

•	Использование вложенной (nested) виртуализации позволяет создавать гостевые ВМ с возможностью запуска гипервизоров/контейнеров внутри них (например, запуск стенда Linux+VirtuaBox на хосте с Windows 10 и т.д.)  

•	Одновременная работа ВМ Hyper-V и контейнеров в Docker на Windows Server 2019 (роль Hyper-V является пререквизитом для установки Docker в таком варианте)  

При этом следует понимать, что при реализации вложенной виртуализации производительность систем может значительно снижаться и основное применение таких вариантов – это лабораторные среды и стенды для проверки функционала. В продуктовом окружении применение такого функционала должно быть хорошо проработано.